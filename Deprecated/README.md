# stream-death-counter
Some simple scripts that can be used in conjunction with Mix It Up to output detailed death statistics for a game

## Files
- **Stats.JSON**: An example file of my own playthroughs which is referenced by the Powershell scripts
- **GetStats.ps1**: Powershell script run by chat commands (facilitated through **Mix It Up**)
- **UpdateStats.ps1**: Powershell script for updating stats run via my **Stream Deck**
- **Current Game.txt**: File that current game deaths get saved to
- **Total.txt**: File that total deaths get saved to
- **Current Boss.txt**: File that current boss deaths get saved to
- **Boss/*.JSON**: Boss data for each playthrough in **Stats.JSON**

## Stats.JSON
**Stats.JSON** contains all the core stat data for the playthroughs done on stream. Playthroughs can be added and updated using the **UpdateStats.ps1** script.

The current properties are:
- _Lookup_: The lookup name for the playthrough used to identify it
- _Game_: The name of the game itself
- _Deaths_: How many deaths have happened in this playthrough (automated)
- _Sessions_: How many sessions have been spent on this game (automated)
- _Status_: Is this playthrough currently in-progress, current, complete etc. (partially automated)
- _VOD_: Link to the Youtube playlist of the VODs
- _Playtime_: How long the playthrough took

## Bosses/*.JSON
Each of the JSON files in the **Bosses** contains all the boss data for the playthrough associated with it (the name of the JSON file will match the _Lookup_ of the playthrough). Bosses can be added and updated using the **UpdateStats.ps1** script.

The current properties are:
- _Lookup_: The lookup name for the boss. This can be autogenerated or manually set
- _Boss_: The name of the boss
- _Deaths_: How many deaths have happened to this boss (automated)
- _Status_: Is this Boss "Defeated", "Undefeated" or "Current"

## GetStats.ps1
The main function of **GetStats.ps1** is to allow Twitch viewers to type commands and arguments which can then retrive specific data about game playthroughs. This started off as just a Death Counter but has expanded to include a more general set of stats for these playthroughs.

All commands are triggered by users with _!stats [arg]_ where _[arg]_ can be any of the following:
- _Total_: Prints summed totals for deaths and sessions of all playthroughs
- _Sheet_: Prints a link to an online spreadsheet of the death data
- _Random_: Provides the stats of a random playthough in the list
- _Current_: Provides the stats of the current playthrough in the list
- _Scheduled_: Provides the sats of the next scheduled playthrough in the list (should it exist)
- _List_: Prints a list of playthroughs that can be used for the _[game]_ arg
- _[game]_: Uses the arg as the _Lookup_ name for **Stats.JSON**

## UpdateStats.ps1
**UpdateStats.ps1** Is an automation tool I use with my Stream Deck to handle updating death counters. Rather than using just simple Text file updating I run this script which will update the **Stats.JSON** file before populating that info to text files that are read by my OBS overlay. As I track Current Game, Current Boss, and Total counts I've found it easier and faster to use a Powershell script as opposed to a multi-action inside Stream Deck.

**UpdateStats.ps1** can be called with a variable number of arguments that are parsed differently. The commands are:

- _death_: Update the Death Counter in some form
  - _add_: Add a death to the current game and total
    - _boss_: Also add a death to the boss marked as "Current"
  - _subtract_: Subtract a death from the current game and total
    - _boss_: Also subtract a death from the boss marked as "Current"
- _setcurrent_: Updates which game is the current game (marking previous current as "In-Progress"
  - [_game_]: The name of the playthrough (using the _Lookup_ property)
- _setcomplete_: Marks the current game as complete
- _sessions_: Increase the _Session_ count for the current playthrough
- _newgame_: Adds a new plythrough entry to **Stats.JSON** and a new boss file to **Bosses** folder
  - [_lookup_]: The _Lookup_ for the new playthrough
  - [_game_]: The name of the _Game_
- _boss_: Commands related to Bosses
  - _new_: Creates a new boss entry
    - [_boss_]: The name of the boss
    - [_lookup_]: An optional parameter to set the _Lookup_ value. Will be autogenerated using _boss_ if not set
  - _list_: Prints out all the _Lookup_ names
  - _setcurrent_: Sets the specified boss to "Current"
    - [_lookup_]: The _Lookup_ of the boss to set to "Current"
  - _defeat_: Marks the current boss as "Defeated"
